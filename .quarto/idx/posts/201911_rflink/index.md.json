{"title":"RFLink 433 MHz RF Gateway","markdown":{"yaml":{"title":"RFLink 433 MHz RF Gateway","author":"Jona","categories":["rf","arduino","pcb","kicad"],"date":"11/29/2019"},"containsRefs":false,"markdown":"\n\n![](IMG_20191024_171635.jpg)\n\nIn this blog post I would like to share my custom RFLink gateway built on top of the [RobotDyn Mega 2560 PRO](https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html) board. You can see the Mega 2560 PRO as an Arduino Mega clone using a more efficient board layout in order to achieve a smaller board size while still exposing all the relevant features of the microcontroller.\n\nI designed a daughter board using KiCAD with the instructions from the [RFLink website](http://www.rflink.nl/blog2/wiring) in order to place the RF parts. I used the Aurel RTX MID 5v transceiver which is recommended by the RFLink team. The fact that it contains receiver and transmitter on the same board simplifies the wiring and enables you to use only one antenna. You could however use any other 433 Mhz RF TX/RX components as described on the site.\n\nHere is the full component list for this project:\n\n- MEGA 2560 PRO Board\n- Custom PCB\n- 100nF ceramic capacitor\n- 10k resistor\n- Bi-directional logic level converter\n- SMA edge connector\n- 433 Mhz SMA antenna\n\nThe MEGA 2560 PRO board uses 3.3V logic levels internally and is not compatible with 5V logic, even though it is powered from 5V USB. It has an on-board LDO converter which provides 3.3V. This means it is not possible to directly hook up the Aurel RTX MID 5v transceiver which works on 5V. I added a [bi-directional logic level converter](https://www.sparkfun.com/products/12009) to the design for this reason, in order to be able to get the devices to talk to each other. When looking around on the Internet, I saw that there is actually a 3.3V version of the Aurel RTX MID (called Aurel RTX MID 3v), which you could hook up directly. However, the 3.3V version appears to be even more difficult to find from resellers than the 5V version, so I went with the 5V version.\n\nIn order to program the Mega board, I used an AVR programmer. I went for the [AVRISP mkII](https://www.microchip.com/DevelopmentTools/ProductDetails/PartNO/ATAVRISP2). I don't think this should be necessary since the board should come preflashed with the Arduino bootloader and you should be able to flash it directly over USB. Mine did not have an Arduino bootloader but this can be due to the fact that I tinkered with it in the past.\n\nYou need to download the [RFLink firmware](http://www.rflink.nl/blog2/download) and extract the RFLink.cpp.hex file which contains the actual binary firmware. (Note that RFLink is not an open source project. The source code for the firmware is not available. They do provide the source code for an old version of the firmware though).\n\nAfter you extracted the firmware, you can flash it directly over USB using the following command:\n\n```bash\navrdude -p atmega2560 -c stk500v2 -P /dev/ttyUSBx -b 115200 -D -Uflash:w:RFLink.cpp.hex:i   \n```\n\nor you can use the AVRISP mkII programmer using this command:\n\n```bash\navrdude -p atmega2560 -c avrispmkII -D -U flash:w:RFLink.cpp.hex:i\n```\n\nIf you run on Windows, you can also use the GUI tool provided in the firmware archive.\n\n\nMy KiCAD project for the daughter board is available here : [https://framagit.org/jaj/rflink-gateway](https://framagit.org/jaj/rflink-gateway).\n\nYou can order the PCB directly from OSH Park here: [https://oshpark.com/shared_projects/cp3NoWn5](https://oshpark.com/shared_projects/cp3NoWn5).\n\nMost parts and devices listed above can be found very cheap from Chinese resellers.\n\nAfter you completed the board, it is possible to hook it up to home automation software over USB. At my place, I use it together with [Home Assistant](https://www.home-assistant.io/integrations/rflink/) and a Raspberry Pi in order to control smart sockets.\n\nHere is a view of the fully assembled board. Maybe at some point I will design a box for it.\n\n![](IMG_20191024_215427.jpg)\n\nLinks:\n\n- [https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html](https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html)\n\n- [http://www.rflink.nl/blog2/wiring](http://www.rflink.nl/blog2/wiring)\n\n- [https://www.sparkfun.com/products/12009](https://www.sparkfun.com/products/12009)\n\n- [https://oshpark.com/shared_projects/cp3NoWn5](https://oshpark.com/shared_projects/cp3NoWn5)\n\n- [https://framagit.org/jaj/rflink-gateway](https://framagit.org/jaj/rflink-gateway)\n","srcMarkdownNoYaml":"\n\n![](IMG_20191024_171635.jpg)\n\nIn this blog post I would like to share my custom RFLink gateway built on top of the [RobotDyn Mega 2560 PRO](https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html) board. You can see the Mega 2560 PRO as an Arduino Mega clone using a more efficient board layout in order to achieve a smaller board size while still exposing all the relevant features of the microcontroller.\n\nI designed a daughter board using KiCAD with the instructions from the [RFLink website](http://www.rflink.nl/blog2/wiring) in order to place the RF parts. I used the Aurel RTX MID 5v transceiver which is recommended by the RFLink team. The fact that it contains receiver and transmitter on the same board simplifies the wiring and enables you to use only one antenna. You could however use any other 433 Mhz RF TX/RX components as described on the site.\n\nHere is the full component list for this project:\n\n- MEGA 2560 PRO Board\n- Custom PCB\n- 100nF ceramic capacitor\n- 10k resistor\n- Bi-directional logic level converter\n- SMA edge connector\n- 433 Mhz SMA antenna\n\nThe MEGA 2560 PRO board uses 3.3V logic levels internally and is not compatible with 5V logic, even though it is powered from 5V USB. It has an on-board LDO converter which provides 3.3V. This means it is not possible to directly hook up the Aurel RTX MID 5v transceiver which works on 5V. I added a [bi-directional logic level converter](https://www.sparkfun.com/products/12009) to the design for this reason, in order to be able to get the devices to talk to each other. When looking around on the Internet, I saw that there is actually a 3.3V version of the Aurel RTX MID (called Aurel RTX MID 3v), which you could hook up directly. However, the 3.3V version appears to be even more difficult to find from resellers than the 5V version, so I went with the 5V version.\n\nIn order to program the Mega board, I used an AVR programmer. I went for the [AVRISP mkII](https://www.microchip.com/DevelopmentTools/ProductDetails/PartNO/ATAVRISP2). I don't think this should be necessary since the board should come preflashed with the Arduino bootloader and you should be able to flash it directly over USB. Mine did not have an Arduino bootloader but this can be due to the fact that I tinkered with it in the past.\n\nYou need to download the [RFLink firmware](http://www.rflink.nl/blog2/download) and extract the RFLink.cpp.hex file which contains the actual binary firmware. (Note that RFLink is not an open source project. The source code for the firmware is not available. They do provide the source code for an old version of the firmware though).\n\nAfter you extracted the firmware, you can flash it directly over USB using the following command:\n\n```bash\navrdude -p atmega2560 -c stk500v2 -P /dev/ttyUSBx -b 115200 -D -Uflash:w:RFLink.cpp.hex:i   \n```\n\nor you can use the AVRISP mkII programmer using this command:\n\n```bash\navrdude -p atmega2560 -c avrispmkII -D -U flash:w:RFLink.cpp.hex:i\n```\n\nIf you run on Windows, you can also use the GUI tool provided in the firmware archive.\n\n\nMy KiCAD project for the daughter board is available here : [https://framagit.org/jaj/rflink-gateway](https://framagit.org/jaj/rflink-gateway).\n\nYou can order the PCB directly from OSH Park here: [https://oshpark.com/shared_projects/cp3NoWn5](https://oshpark.com/shared_projects/cp3NoWn5).\n\nMost parts and devices listed above can be found very cheap from Chinese resellers.\n\nAfter you completed the board, it is possible to hook it up to home automation software over USB. At my place, I use it together with [Home Assistant](https://www.home-assistant.io/integrations/rflink/) and a Raspberry Pi in order to control smart sockets.\n\nHere is a view of the fully assembled board. Maybe at some point I will design a box for it.\n\n![](IMG_20191024_215427.jpg)\n\nLinks:\n\n- [https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html](https://robotdyn.com/catalog/arduino/boards/matrix-led-8x8-module-32x32mm-driver-max7219-7221.html)\n\n- [http://www.rflink.nl/blog2/wiring](http://www.rflink.nl/blog2/wiring)\n\n- [https://www.sparkfun.com/products/12009](https://www.sparkfun.com/products/12009)\n\n- [https://oshpark.com/shared_projects/cp3NoWn5](https://oshpark.com/shared_projects/cp3NoWn5)\n\n- [https://framagit.org/jaj/rflink-gateway](https://framagit.org/jaj/rflink-gateway)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.33","theme":{"light":"flatly","dark":"slate"},"title-block-banner":true,"title":"RFLink 433 MHz RF Gateway","author":"Jona","categories":["rf","arduino","pcb","kicad"],"date":"11/29/2019"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}